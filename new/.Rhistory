setwd("C:/Users/arvbr/OneDrive/Documents/GitHub/Predictive-Analysis/Decision Trees")
#Libraries
install.packages("psych")
library(psych)
#Loading the dataset ----
ins <-  read.csv(file = "insurance.csv",stringsAsFactors = F)
new.ins<- subset(ins,select = c("age","bmi","children","charges"))
#Modelling ----
model <- lm(charges ~ . ,ins)
model2<- lm(charges ~ .,new.ins)
#Analyzing ----
hist(ins$age)
table(ins$region)
cor(ins[c("age","bmi","children","charges")])
pairs(ins[c("age","bmi","children","charges")])
pairs.panels(ins[c("age","bmi","children","charges")])
summary(ins$charges)
#Analyzing ----
hist(ins$age)
table(ins$region)
plot(ins$age)
boxplot(ins$age)
cor(ins[c("age","bmi","children","charges")])
pairs(ins[c("age","bmi","children","charges")])
pairs.panels(ins[c("age","bmi","children","charges")])
pairs(ins[c("age","bmi","children","charges")])
pairs.panels(ins[c("age","bmi","children","charges")])
pairs.panels(ins[c("age","bmi","children","charges")])
#Modelling ----
model <- lm(charges ~ . ,ins)
model2<- lm(charges ~ .,new.ins)
#Modelling ----
model <- lm(charges ~ . ,ins)
#Prediction ----
df<- data.frame(age=24,sex="male",bmi=34.5,children=3,smoker="no",region="southeast")
predict(model,df)
ins$age2 <- ins$age^2
View(ins)
ins$bmi30 <- ins[ifelse(ins$bmi>=30,1,0),]
ins$bmi30 <- ins[ifelse(ins$bmi=>30,1,0),]
ins$bmi30 <- ifelse(ins$bmi=>30,1,0)
ins$bmi30 <- ifelse(ins$bmi>+30,1,0)
ins$bmi30 <- ifelse(ins$bmi>=30,1,0)
View(ins)
model2<- lm(charges ~ .,ins)
df2<- data.frame(age=25,sex="female",bmi=30.2,children=2,smoker="no",region="northeast",age2=625,bmi30=1)
predict(model2,df2)
#loading the dataset
possal <- read.csv(file = "Position_Salaries",stringsAsFactors = F)
#loading the dataset
possal <- read.csv(file = "Position_Salaries.csv",stringsAsFactors = F)
str(possal)
summary(possal)
table(possal$Position)
hist(possal$Salary)
View(possal)
possal1 <- possal[c(2:3),]
possal1 <- possal[,c(2:3)]
View(possal1)
#
model <- lm(Salary ~ .)
#
model <- lm(Salary ~ .,possal1)
hist(possal$Position)
hist(possal$Level)
#loading the dataset
possal <- read.csv(file = "Position_Salaries.csv",stringsAsFactors = F)
#Analyzing
str(possal)
summary(possal)
table(possal$Position)
hist(possal$Level)
View(possal)
#Selecting 2nd and 3rd column
possal1 <- possal[2:3]
#Linear Regression Model
lm.model <- lm(Salary ~ .,possal1)
summary(model)
summary(lm.model)
#
possal1$Level2 <- possal1$Level^2
possal1$Level3 <- possal1$Level^3
View(possal1)
possal1$Level4 <- possal1$Level^4
#
poly.model <- lm(Salary ~ . ,possal1)
summary(poly.model)
#
library(ggplot2)
#Visualizing
ggplot()+
geom_point(possal1,aes(Level,Salary))
#Visualizing
ggplot()+
geom_point(aes(Level,Salary),possal1)
#Visualizing
ggplot()+
geom_point(aes(Level,Salary),possal1)+
geom_line(aes(Level,predict(lm.model,possal1)))
#Visualizing
ggplot()+
geom_point(aes(Level,Salary),possal1)+
geom_line(aes(Level,predict(lm.model,possal1)),possal1)
#Visualizing
ggplot()+
geom_point(aes(Level,Salary),possal1,colour = "red")+
geom_line(aes(Level,predict(lm.model,possal1)),possal1,colour = "orange")+
ggtitle("Truth or Bluff(Linear Regression)")+
xlab("Level")+
ylab("Salary")
#Visualizing
ggplot()+
geom_point(aes(Level,Salary),possal1,colour = "green")+
geom_line(aes(Level,predict(lm.model,possal1)),possal1,colour = "orange")+
ggtitle("Truth or Bluff(Linear Regression)")+
xlab("Level")+
ylab("Salary")
#Visualizing
ggplot()+
geom_point(aes(Level,Salary),possal1,colour = "green")+
geom_line(aes(Level,predict(lm.model,possal1)),possal1,colour = "orange")+
ggtitle("Truth or Bluff(Linear Regression)")
#Visualizing
ggplot()+
geom_point(aes(Level,Salary),possal1,colour = "green")+
geom_line(aes(Level,predict(lm.model,possal1)),possal1,colour = "orange")+
ggtitle("Truth or Bluff(Linear Regression)")+
theme_bw()
#Visualizing
ggplot()+
geom_point(aes(Level,Salary),possal1,colour = "green")+
geom_line(aes(Level,predict(lm.model,possal1)),possal1,colour = "orange")+
ggtitle("Truth or Bluff(Linear Regression)")+
theme_get()
#Visualizing
ggplot()+
geom_point(aes(Level,Salary),possal1,colour = "green")+
geom_line(aes(Level,predict(lm.model,possal1)),possal1,colour = "orange")+
ggtitle("Truth or Bluff(Linear Regression)")+
theme_classic()
#Visualizing
ggplot()+
geom_point(aes(Level,Salary),possal1,colour = "green")+
geom_line(aes(Level,predict(lm.model,possal1)),possal1,colour = "orange")+
ggtitle("Truth or Bluff(Linear Regression)")+
theme_dark()
ggplot()+
geom_point(aes(Level,Salary),possal1,colour = "green")+
geom_line(aes(Level,predict(poly.model,possal1)),possal1,colour = "orange")+
ggtitle("Truth or Bluff(Linear Regression)")+
theme_linedraw()
ggplot()+
geom_point(aes(Level,Salary),possal1,colour = "green")+
geom_line(aes(Level,predict(poly.model,possal1)),possal1,colour = "orange")+
ggtitle("Truth or Bluff(Linear Regression)")+
theme_grey()
ggplot()+
geom_point(aes(Level,Salary),possal1,colour = "green")+
geom_line(aes(Level,predict(poly.model,possal1)),possal1,colour = "orange")+
ggtitle("Truth or Bluff(Linear Regression)")+
theme_dark()
ggplot()+
geom_point(aes(Level,Salary),possal1,colour = "green")+
geom_line(aes(Level,predict(poly.model,possal1)),possal1,colour = "orange")+
ggtitle("Truth or Bluff(Polynomial Regression)")+
theme_dark()
#Visualizing
ggplot()+
geom_point(aes(Level,Salary),possal1,colour = "green")+
geom_line(aes(Level,predict(lm.model,possal1)),possal1,colour = "orange")+
ggtitle("Truth or Bluff(Linear Regression)")+
theme_dark()
ggplot()+
geom_point(aes(Level,Salary),possal1,colour = "green")+
geom_line(aes(Level,predict(poly.model,possal1)),possal1,colour = "orange")+
ggtitle("Truth or Bluff(Polynomial Regression)")+
theme_dark()
predict(lm.model,data.frame(Level=6.5))
predict(poly.model,data.frame(Level=6.5,
Level2=6.5^2,
Level3=6.5^3,
Level4=6.5^4))
#Visualizing
ggplot()+
geom_point(aes(Level,Salary),possal1,colour = "green")+
geom_line(aes(Level,predict(lm.model,possal1)),possal1,colour = "orange")+
ggtitle("Truth or Bluff(Linear Regression)")+
theme_dark()
#
pos <- read.csv(file = "Position_Salaries.csv")
#
summary(pos)
str(pos)
View(pos)
cor(pos$Level,pos$Salary)
cor(pos)
table(pos$Position)
hist(pos$Position,pos$Salary)
hist(pos$Level,pos$Salary)
hist(pos$Level,pos$Salary)
hist(pos$Salary)
#
pos<- pos[2:3]
lm.model <- lm(Salary ~ . , pos)
#
pos <- read.csv(file = "Position_Salaries.csv",stringsAsFactors = F)
#
summary(pos)
str(pos)
cor(pos$Level,pos$Salary)
table(pos$Position)
hist(pos$Salary)
#
pos<- pos[2:3]
lm.model <- lm(Salary ~ . , pos)
help(seq)
#Packages Required
library(ggplot2)
#loading the dataset
possal <- read.csv(file = "Position_Salaries.csv",stringsAsFactors = F)
#Analyzing
str(possal)
summary(possal)
table(possal$Position)
hist(possal$Level)
View(possal)
#Selecting 2nd and 3rd column
pos <- possal[2:3]
#Linear Regression Model
lm.model <- lm(Salary ~ .,pos)
summary(lm.model)
#Fitting some variables for Polynomial Regression
pos$Level2 <- pos$Level^2
pos$Level3 <- pos$Level^3
pos$Level4 <- pos$Level^4
#Polynomial Regression Model
poly.model <- lm(Salary ~ . ,pos)
summary(poly.model)
#Visualizing both the models
ggplot()+
geom_point(aes(Level,Salary),pos,colour = "green")+
geom_line(aes(Level,predict(lm.model,pos)),pos,colour = "orange")+
ggtitle("Truth or Bluff(Linear Regression)")+
theme_dark()
ggplot()+
geom_point(aes(Level,Salary),pos,colour = "green")+
geom_line(aes(Level,predict(poly.model,pos)),pos,colour = "orange")+
ggtitle("Truth or Bluff(Polynomial Regression)")+
theme_dark()
ggplot()+
geom_point(aes(Level,Salary),pos,colour = "blue")+
geom_line(aes(x_grid,predict(poly.model,data.frame(Level = x_grid,
Level2 = Level^2,
Level3 = Level^3,
Level4 = Level^4))),colour = "red")
#
x_grid <- seq(min(pos$Level),max(pos$Level),0.1)
ggplot()+
geom_point(aes(Level,Salary),pos,colour = "blue")+
geom_line(aes(x_grid,predict(poly.model,data.frame(Level = x_grid,
Level2 = Level^2,
Level3 = Level^3,
Level4 = Level^4))),colour = "red")
View(pos)
#Packages Required
library(ggplot2)
#loading the dataset
possal <- read.csv(file = "Position_Salaries.csv",stringsAsFactors = F)
#Analyzing
str(possal)
summary(possal)
table(possal$Position)
hist(possal$Level)
View(possal)
#Selecting 2nd and 3rd column
pos <- possal[2:3]
#Linear Regression Model
lm.model <- lm(Salary ~ .,pos)
summary(lm.model)
#Fitting some variables for Polynomial Regression
pos$Level2 <- pos$Level^2
pos$Level3 <- pos$Level^3
pos$Level4 <- pos$Level^4
#Polynomial Regression Model
poly.model <- lm(Salary ~ . ,pos)
summary(poly.model)
#Visualizing both the models
ggplot()+
geom_point(aes(Level,Salary),pos,colour = "green")+
geom_line(aes(Level,predict(lm.model,pos)),pos,colour = "orange")+
ggtitle("Truth or Bluff(Linear Regression)")+
theme_dark()
ggplot()+
geom_point(aes(Level,Salary),pos,colour = "green")+
geom_line(aes(Level,predict(poly.model,pos)),pos,colour = "orange")+
ggtitle("Truth or Bluff(Polynomial Regression)")+
theme_dark()
#
x_grid <- seq(min(pos$Level),max(pos$Level),0.1)
ggplot()+
geom_point(aes(Level,Salary),
pos,colour = "blue")+
geom_line(aes(x_grid,predict(poly.model,data.frame(Level = x_grid,
Level2 = Level^2,
Level3 = Level^3,
Level4 = Level^4))),
colour = "red")
rlang::last_trace()
ggplot()+
geom_point(aes(pos$Level,Salary),
pos,colour = "blue")+
geom_line(aes(x_grid,predict(poly.model,data.frame(Level = x_grid,
Level2 = Level^2,
Level3 = Level^3,
Level4 = Level^4))),
colour = "red")
ggplot()+
geom_point(aes(Level,Salary),
pos,colour = "blue")+
geom_line(aes(x_grid,predict(poly.model,data.frame(Level = x_grid,
Level2 = Level^2,
Level3 = Level^3,
Level4 = Level^4))),
colour = "red")
ggplot()+
geom_point(aes(Level,Salary),
pos,colour = "blue")+
geom_line(aes(x_grid,predict(poly.model,data.frame(Level = x_grid,
Level2 = Level^2,
Level3 = Level^3,
Level4 = Level^4))),
ggplot()+
geom_point(aes(Level,Salary),
pos,colour = "blue")+
geom_line(aes(x_grid,predict(poly.model,data.frame(Level = x_grid,
Level2 = Level^2,
Level3 = Level^3,
Level4 = Level^4))),
colour = "red")
ggplot()+
ggplot()+
geom_point(aes(Level,Salary),pos,colour = "green")+
geom_line(aes(Level,predict(poly.model,pos)),pos,colour = "orange")+
ggtitle("Truth or Bluff(Polynomial Regression)")+
theme_dark()
ggplot()+
geom_point(aes(Level,Salary),
pos,colour = "blue")+
geom_line(aes(x_grid,predict(poly.model,data.frame(Level = x_grid,
Level2 = Level^2,
Level3 = Level^3,
Level4 = Level^4))),
colour = "red")
pos
ggplot()+
geom_point(aes(Level,Salary),
pos,colour = "blue")+
geom_line(aes(x_grid,predict(poly.model,data.frame(Level = x_grid,
Level2 = x_grid^2,
Level3 = x_grid^3,
Level4 = x_grid^4))),
colour = "red")
ggplot()+
geom_point(aes(Level,Salary),
pos,colour = "blue")+
geom_line(aes(x_grid,predict(poly.model,data.frame(Level = x_grid,
Level2 = x_grid^2,
Level3 = x_grid^3,
Level4 = x_grid^4))),
colour = "red")+
theme_dark()
ggplot()+
geom_point(aes(Level,Salary),
pos,colour = "blue")+
geom_line(aes(x_grid,predict(poly.model,data.frame(Level = x_grid,
Level2 = x_grid^2,
Level3 = x_grid^3,
Level4 = x_grid^4))),
colour = "red")+
geom_tile("Polynomial Regression")+
theme_dark()
ggplot()+
geom_point(aes(Level,Salary),
pos,colour = "blue")+
geom_line(aes(x_grid,predict(poly.model,data.frame(Level = x_grid,
Level2 = x_grid^2,
Level3 = x_grid^3,
Level4 = x_grid^4))),
colour = "red")+
ggtitle("Polynomial Regression")+
theme_dark()
#Visualizing both the models
ggplot()+
geom_point(aes(Level,Salary),pos,colour = "green")+
geom_line(aes(Level,predict(lm.model,pos)),pos,colour = "orange")+
ggtitle("Truth or Bluff(Linear Regression)")+
theme_dark()
ggplot()+
geom_point(aes(Level,Salary),pos,colour = "green")+
geom_line(aes(Level,predict(poly.model,pos)),pos,colour = "orange")+
ggtitle("Truth or Bluff(Polynomial Regression)")+
theme_dark()
setwd("C:/Users/arvbr/OneDrive/Documents/GitHub/Predictive-Analysis/new")
Cd <- read.csv(file = "Concrete_Data.csv",stringsAsFactors = F)
View(Cd)
hist(Cd$strength)
summary(Cd)
str(Cd)
normalize <- function(x){return((x-min(x))/(max(x)-min((x))))}
Cd.norm <- data.frame(lapply(Cd,normalize))
View(Cd.norm)
hist(Cd$strength)
hist(Cd.norm$strength)
Cd.train <- Cd[1:720,]
Cd.test <- Cd[721:1030,]
hist(Cd.norm$strength)
